{"ast":null,"code":"import _regeneratorRuntime from\"/home/paulo-guilherme-dev/projetos/sd-023-b-project-trybetunes/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/paulo-guilherme-dev/projetos/sd-023-b-project-trybetunes/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/home/paulo-guilherme-dev/projetos/sd-023-b-project-trybetunes/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/paulo-guilherme-dev/projetos/sd-023-b-project-trybetunes/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/home/paulo-guilherme-dev/projetos/sd-023-b-project-trybetunes/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/paulo-guilherme-dev/projetos/sd-023-b-project-trybetunes/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component}from'react';import{addSong,removeSong,getFavoriteSongs}from'../services/favoriteSongsAPI';import Loading from'./Loading';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MusicCard=/*#__PURE__*/function(_Component){_inherits(MusicCard,_Component);var _super=_createSuper(MusicCard);function MusicCard(){var _this;_classCallCheck(this,MusicCard);_this=_super.call(this);_this.isChecked=function(_ref){var target=_ref.target;var _this$props=_this.props,albumMusics=_this$props.albumMusics,index=_this$props.index;if(target.checked){_this.setState({isChecked:true,loading:true},/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return addSong(albumMusics[index]);case 2:_this.setState({loading:false});case 3:case\"end\":return _context.stop();}}},_callee);})));}else{_this.setState({isChecked:false,loading:true},/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return removeSong(albumMusics[index]);case 2:_this.setState({loading:false},function(){var checkFavorite=_this.props.checkFavorite;checkFavorite();});case 3:case\"end\":return _context2.stop();}}},_callee2);})));}};_this.state={loading:false,isChecked:false};return _this;}_createClass(MusicCard,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var _this2=this;var trackId,listOfFavMusics,isChecked;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:trackId=this.props.trackId;_context3.next=3;return getFavoriteSongs();case 3:listOfFavMusics=_context3.sent;isChecked=listOfFavMusics.some(function(music){return music.trackId===trackId;});this.setState({loading:true,isChecked:isChecked},function(){return _this2.setState({loading:false});});case 6:case\"end\":return _context3.stop();}}},_callee3,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var _this$state=this.state,loading=_this$state.loading,isChecked=_this$state.isChecked;var _this$props2=this.props,trackName=_this$props2.trackName,previewUrl=_this$props2.previewUrl,trackId=_this$props2.trackId;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{children:loading?/*#__PURE__*/_jsx(Loading,{}):trackName}),/*#__PURE__*/_jsxs(\"audio\",{\"data-testid\":\"audio-component\",src:previewUrl,controls:true,children:[/*#__PURE__*/_jsx(\"track\",{kind:\"captions\"}),\"O seu navegador n\\xE3o suporta o elemento\",previewUrl,/*#__PURE__*/_jsx(\"code\",{children:\"audio\"}),\".\"]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:trackId,\"data-testid\":\"checkbox-music-\".concat(trackId),children:[\"Favorita\",/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"favorites\",id:trackId,onChange:this.isChecked,checked:isChecked})]})]});}}]);return MusicCard;}(Component);MusicCard.defaultProps={checkFavorite:function checkFavorite(){}};export default MusicCard;","map":{"version":3,"names":["React","Component","addSong","removeSong","getFavoriteSongs","Loading","MusicCard","isChecked","target","props","albumMusics","index","checked","setState","loading","checkFavorite","state","trackId","listOfFavMusics","some","music","trackName","previewUrl","defaultProps"],"sources":["/home/paulo-guilherme-dev/projetos/sd-023-b-project-trybetunes/src/components/MusicCard.js"],"sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { addSong, removeSong, getFavoriteSongs } from '../services/favoriteSongsAPI';\nimport Loading from './Loading';\n\nclass MusicCard extends Component {\n  constructor() {\n    super();\n    this.state = {\n      loading: false,\n      isChecked: false,\n    };\n  }\n\n  async componentDidMount() {\n    const { trackId } = this.props;\n    const listOfFavMusics = await getFavoriteSongs();\n    const isChecked = listOfFavMusics.some((music) => music.trackId === trackId);\n    this.setState({ loading: true, isChecked }, () => this.setState({ loading: false }));\n  }\n\n  isChecked = ({ target }) => {\n    const { albumMusics, index } = this.props;\n    if (target.checked) {\n      this.setState({ isChecked: true, loading: true }, async () => {\n        await addSong(albumMusics[index]);\n        this.setState({ loading: false });\n      });\n    } else {\n      this.setState({ isChecked: false, loading: true }, async () => {\n        await removeSong(albumMusics[index]);\n        this.setState({ loading: false }, () => {\n          const { checkFavorite } = this.props;\n          checkFavorite();\n        });\n      });\n    }\n  }\n\n  render() {\n    const { loading, isChecked } = this.state;\n    const { trackName, previewUrl, trackId } = this.props;\n    return (\n      <div>\n        <h4>{loading ? <Loading /> : trackName}</h4>\n        <audio\n          data-testid=\"audio-component\"\n          src={ previewUrl }\n          controls\n        >\n          <track kind=\"captions\" />\n          O seu navegador n√£o suporta o elemento\n          {previewUrl}\n          <code>\n            audio\n          </code>\n          .\n        </audio>\n        <label htmlFor={ trackId } data-testid={ `checkbox-music-${trackId}` }>\n          Favorita\n          <input\n            type=\"checkbox\"\n            name=\"favorites\"\n            id={ trackId }\n            onChange={ this.isChecked }\n            checked={ isChecked }\n          />\n        </label>\n      </div>\n    );\n  }\n}\n\nMusicCard.propTypes = {\n  trackName: PropTypes.string.isRequired,\n  previewUrl: PropTypes.string.isRequired,\n  trackId: PropTypes.number.isRequired,\n  albumMusics: PropTypes.arrayOf(PropTypes.object.isRequired).isRequired,\n  index: PropTypes.number.isRequired,\n  checkFavorite: PropTypes.func,\n};\n\nMusicCard.defaultProps = {\n  checkFavorite: () => {},\n};\n\nexport default MusicCard;\n"],"mappings":"w3BAAA,MAAOA,MAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CAEA,OAASC,OAAT,CAAkBC,UAAlB,CAA8BC,gBAA9B,KAAsD,8BAAtD,CACA,MAAOC,QAAP,KAAoB,WAApB,C,2FAEMC,U,sGACJ,oBAAc,2CACZ,wBADY,MAedC,SAfc,CAeF,cAAgB,IAAbC,OAAa,MAAbA,MAAa,CAC1B,gBAA+B,MAAKC,KAApC,CAAQC,WAAR,aAAQA,WAAR,CAAqBC,KAArB,aAAqBA,KAArB,CACA,GAAIH,MAAM,CAACI,OAAX,CAAoB,CAClB,MAAKC,QAAL,CAAc,CAAEN,SAAS,CAAE,IAAb,CAAmBO,OAAO,CAAE,IAA5B,CAAd,wEAAkD,2JAC1CZ,QAAO,CAACQ,WAAW,CAACC,KAAD,CAAZ,CADmC,QAEhD,MAAKE,QAAL,CAAc,CAAEC,OAAO,CAAE,KAAX,CAAd,EAFgD,sDAAlD,IAID,CALD,IAKO,CACL,MAAKD,QAAL,CAAc,CAAEN,SAAS,CAAE,KAAb,CAAoBO,OAAO,CAAE,IAA7B,CAAd,wEAAmD,iKAC3CX,WAAU,CAACO,WAAW,CAACC,KAAD,CAAZ,CADiC,QAEjD,MAAKE,QAAL,CAAc,CAAEC,OAAO,CAAE,KAAX,CAAd,CAAkC,UAAM,CACtC,GAAQC,cAAR,CAA0B,MAAKN,KAA/B,CAAQM,aAAR,CACAA,aAAa,GACd,CAHD,EAFiD,wDAAnD,IAOD,CACF,CA/Ba,CAEZ,MAAKC,KAAL,CAAa,CACXF,OAAO,CAAE,KADE,CAEXP,SAAS,CAAE,KAFA,CAAb,CAFY,aAMb,C,mJAED,gMACUU,OADV,CACsB,KAAKR,KAD3B,CACUQ,OADV,wBAEgCb,iBAAgB,EAFhD,QAEQc,eAFR,gBAGQX,SAHR,CAGoBW,eAAe,CAACC,IAAhB,CAAqB,SAACC,KAAD,QAAWA,MAAK,CAACH,OAAN,GAAkBA,OAA7B,EAArB,CAHpB,CAIE,KAAKJ,QAAL,CAAc,CAAEC,OAAO,CAAE,IAAX,CAAiBP,SAAS,CAATA,SAAjB,CAAd,CAA4C,iBAAM,OAAI,CAACM,QAAL,CAAc,CAAEC,OAAO,CAAE,KAAX,CAAd,CAAN,EAA5C,EAJF,6D,mIAyBA,iBAAS,CACP,gBAA+B,KAAKE,KAApC,CAAQF,OAAR,aAAQA,OAAR,CAAiBP,SAAjB,aAAiBA,SAAjB,CACA,iBAA2C,KAAKE,KAAhD,CAAQY,SAAR,cAAQA,SAAR,CAAmBC,UAAnB,cAAmBA,UAAnB,CAA+BL,OAA/B,cAA+BA,OAA/B,CACA,mBACE,oCACE,oBAAKH,OAAO,cAAG,KAAC,OAAD,IAAH,CAAiBO,SAA7B,EADF,cAEE,eACE,cAAY,iBADd,CAEE,GAAG,CAAGC,UAFR,CAGE,QAAQ,KAHV,wBAKE,cAAO,IAAI,CAAC,UAAZ,EALF,6CAOGA,UAPH,cAQE,+BARF,OAFF,cAeE,eAAO,OAAO,CAAGL,OAAjB,CAA2B,uCAAgCA,OAAhC,CAA3B,mCAEE,cACE,IAAI,CAAC,UADP,CAEE,IAAI,CAAC,WAFP,CAGE,EAAE,CAAGA,OAHP,CAIE,QAAQ,CAAG,KAAKV,SAJlB,CAKE,OAAO,CAAGA,SALZ,EAFF,GAfF,GADF,CA4BD,C,uBAjEqBN,S,EA6ExBK,SAAS,CAACiB,YAAV,CAAyB,CACvBR,aAAa,CAAE,wBAAM,CAAE,CADA,CAAzB,CAIA,cAAeT,UAAf"},"metadata":{},"sourceType":"module"}